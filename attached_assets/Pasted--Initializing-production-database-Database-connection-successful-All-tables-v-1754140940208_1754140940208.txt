      
ğŸ”§ Initializing production database...

âœ… Database connection successful

âœ… All tables verified/created successfully

ğŸ”„ Running database migrations...

ğŸ”§ CRITICAL FIX: Correcting deliveries status constraint...

âœ… CRITICAL FIX: Deliveries status constraint corrected to allow planned status

âœ… Updated name column with existing data

ğŸ”§ CRITICAL FIX: Ensuring NocoDB BL columns exist...

âœ… Updated NocoDB BL column default values

ğŸ”§ CRITICAL FIX v2: Forcing tasks table completed columns for production...

ğŸ“‹ Current completed columns: [ { column_name: 'completed_at' }, { column_name: 'completed_by' } ]

âœ… Dropped constraints

âœ… Dropped old columns

âœ… Added new columns

âœ… Added constraints

ğŸ‰ CRITICAL FIX v2 COMPLETED. Final structure: [

  {

    column_name: 'completed_at',

    data_type: 'timestamp without time zone',

    is_nullable: 'YES'

  },

  {

    column_name: 'completed_by',

    data_type: 'character varying',

    is_nullable: 'YES'

  }

]

âœ… Removed old orders_status_check constraint

âœ… Added updated orders_status_check constraint

âœ… ALL tables created including CRITICAL user_roles table

âœ… All migrations completed successfully

âœ… System user already exists

âœ… Admin user exists with custom password - not resetting

ğŸ­ Initializing roles and permissions for production...

ğŸ”’ VÃ©rification du systÃ¨me de rÃ´les fixes...

âœ… RÃ´le fixe existe: Administrateur

âœ… RÃ´le fixe existe: Manager

âœ… RÃ´le fixe existe: EmployÃ©

âœ… RÃ´le fixe existe: Directeur

âœ… Nettoyage des anciens rÃ´les systÃ¨me terminÃ© - rÃ´les fixes prÃ©servÃ©s

ğŸ”‘ Assignment des permissions aux rÃ´les fixes...

âœ… Admin: 54 permissions assignÃ©es

âœ… Manager: permissions assignÃ©es (tout sauf administration, avec validation livraisons)

âœ… Employee: 15 permissions de base assignÃ©es

âœ… Directeur: permissions assignÃ©es (tout sauf administration)

ğŸ‘¥ Assignment des utilisateurs aux rÃ´les fixes...

âœ… admin_local assignÃ© au rÃ´le Administrateur

âŒ Nicolas introuvable avec ID _1753182518439

âœ… ff292 assignÃ© au rÃ´le EmployÃ©

âœ… Roles already exist, checking for missing DLC permissions...

ğŸ” Checking for missing DLC permissions...

âœ… All DLC permissions already exist

âœ… Database initialization complete

ğŸ”„ DÃ‰SACTIVÃ‰: Migrations automatiques (webhook_url existe dÃ©jÃ  en production)

âœ… Migrations ignorÃ©es - colonnes dÃ©jÃ  prÃ©sentes en base

âœ… Local authentication configured

ğŸ”§ Backup service using directory: /tmp/logiflow-backups (production storage: true)

ğŸ”§ Backup service using directory: /tmp/logiflow-backups (production storage: true)

âœ… Scheduler service initialized successfully

ğŸ”§ SETUP SIMPLE VERIFY - Function called, registering route /api/verify-invoices

âœ… SETUP SIMPLE VERIFY - Route /api/verify-invoices registered successfully

ğŸ§ª Webhook test route registered

âœ… Serving static files from: /app/dist/public

1:20:50 PM [express] Server running on port 3000

âœ… Backup service initialized successfully

1:20:54 PM [express] HEAD /api/health 200 in 4ms

1:21:24 PM [express] HEAD /api/health 200 in 1ms

1:21:54 PM [express] HEAD /api/health 200 in 1ms