ğŸ”„ SERVER STARTUP: Initializing database...

ğŸ“‹ SERVER STARTUP: Dashboard messages migration should be included in database initialization

ğŸ”§ Initializing production database...

âœ… Database connection successful

âœ… All tables verified/created successfully

ğŸ“‹ INIT DATABASE: About to call runMigrations() which includes dashboard messages migration

ğŸ”„ Running database migrations...

ğŸ”§ CRITICAL FIX: Correcting deliveries status constraint...

âœ… CRITICAL FIX: Deliveries status constraint corrected to allow planned status

âœ… Updated name column with existing data

ğŸ”§ CRITICAL FIX: Ensuring NocoDB BL columns exist...

âœ… Updated NocoDB BL column default values

ğŸ”§ CRITICAL FIX v2: Forcing tasks table completed columns for production...

ğŸ“‹ Current completed columns: [ { column_name: 'completed_at' }, { column_name: 'completed_by' } ]

âœ… Dropped constraints

âœ… Dropped old columns

âœ… Added new columns

âœ… Added constraints

ğŸ‰ CRITICAL FIX v2 COMPLETED. Final structure: [

  {

    column_name: 'completed_at',

    data_type: 'timestamp without time zone',

    is_nullable: 'YES'

  },

  {

    column_name: 'completed_by',

    data_type: 'character varying',

    is_nullable: 'YES'

  }

]

âœ… Removed old orders_status_check constraint

âœ… Added updated orders_status_check constraint

âœ… ALL tables created including CRITICAL user_roles table

ğŸ“‹ VERIFICATION: Checking if migrateDashboardMessages function exists...

âœ… VERIFICATION: migrateDashboardMessages function exists and is callable

ğŸ”„ DASHBOARD MESSAGES MIGRATION: Starting migration process...

ğŸ“‹ DASHBOARD MESSAGES MIGRATION: Function successfully called from runMigrations()

ğŸ”„ Running dashboard messages migration...

ğŸ“‹ Dashboard messages table already exists

âœ… Performance indexes created for dashboard_messages

ğŸ“‹ Dashboard messages table structure:

  - id: integer NOT NULL DEFAULT nextval('dashboard_messages_id_seq'::regclass)

  - title: character varying NOT NULL 

  - content: text NOT NULL 

  - type: character varying NOT NULL DEFAULT 'info'::character varying

  - store_id: integer NULL 

  - created_by: character varying NOT NULL 

  - created_at: timestamp without time zone NULL DEFAULT CURRENT_TIMESTAMP

âœ… Dashboard messages migration completed successfully

âœ… All migrations completed successfully

âœ… INIT DATABASE: runMigrations() completed successfully

âœ… System user already exists

âœ… Admin user exists with custom password - not resetting

ğŸ­ Initializing roles and permissions for production...

ğŸ”’ VÃ©rification du systÃ¨me de rÃ´les fixes...

âœ… RÃ´le fixe existe: Administrateur

âœ… RÃ´le fixe existe: Manager

âœ… RÃ´le fixe existe: EmployÃ©

âœ… RÃ´le fixe existe: Directeur

âœ… Nettoyage des anciens rÃ´les systÃ¨me terminÃ© - rÃ´les fixes prÃ©servÃ©s

ğŸ”‘ Assignment des permissions aux rÃ´les fixes...

âœ… Admin: 54 permissions assignÃ©es

âœ… Manager: permissions assignÃ©es (tout sauf administration, avec validation livraisons)

âœ… Employee: 15 permissions de base assignÃ©es

âœ… Directeur: permissions assignÃ©es (tout sauf administration)

ğŸ‘¥ Assignment des utilisateurs aux rÃ´les fixes...

âœ… admin_local assignÃ© au rÃ´le Administrateur

âŒ Nicolas introuvable avec ID _1753182518439

âœ… ff292 assignÃ© au rÃ´le EmployÃ©

âœ… Roles already exist, checking for missing DLC permissions...

ğŸ” Checking for missing DLC permissions...

âœ… All DLC permissions already exist

âœ… Database initialization complete

âœ… SERVER STARTUP: Database initialization completed successfully

âœ… Migrations automatiques ignorÃ©es - base de donnÃ©es dÃ©jÃ  Ã  jour

âœ… Local authentication configured

ğŸ”§ Backup service using directory: /tmp/logiflow-backups (production storage: true)

ğŸ”§ Backup service using directory: /tmp/logiflow-backups (production storage: true)

âœ… Scheduler service initialized successfully with production database

ğŸ“… Services de planification prÃªts Ã  Ãªtre activÃ©s via l'interface

ğŸ”§ SETUP SIMPLE VERIFY - Function called, registering route /api/verify-invoices

âœ… SETUP SIMPLE VERIFY - Route /api/verify-invoices registered successfully

ğŸ§ª Webhook test route registered

ğŸš€ Services programmÃ©s initialisÃ©s et prÃªts Ã  Ãªtre activÃ©s

âœ… Serving static files from: /app/dist/public

10:00:12 AM [express] Server running on port 3000

âœ… Backup service initialized successfully

10:00:15 AM [express] HEAD /api/health 200 in 7ms


      
      
    